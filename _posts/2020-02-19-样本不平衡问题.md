---

layout:     post
title:      样本不平衡问题
subtitle:   
date:       2020-02-19
author:     bjmsong
header-img: img/machineLearning/machineLearning.png
catalog: true
tags:
    - 机器学习
---



### 非平衡样本问题可以尝试的方法

- 采样

  - 对数据多的那一类样本进行降采样
  - 对数据少的那一类样本进行过采样：smote

- 自定义loss function
  
  - Use a asymmetric cost function to artificially balance the training process ：增大少类样本的权重
  - https://xgboost.readthedocs.io/en/latest/tutorials/custom_metric_obj.html
  - https://blog.csdn.net/A_a_ron/article/details/79050204
  
- One Class Learning

  - Just assume your data has a few real points (the ones) and lots of random noise that doesn't physically exists leaked into the dataset (anything that is not a one is noise). Use an algorithm to denoise the data instead of a classification algorithm
  - 当成一个异常检测的问题

- 其它

  - 使用F1，而不是AUC
  - 自定义评价函数

  ```
  xgb.train(params, dtrain, num_rounds, watchlist, feval=misclassified, maximize=False)
  
  def misclassified(pred_probs, dtrain):
  
  	labels = dtrain.get_label() # obtain true labels
  
  	preds = pred_probs > 0.5 # obtain predicted values
  
  	return 'misclassified', np.sum(labels != preds)
  ```

  - 调参，如xgboost min_child_weight 设的小一点
    - scale_pos_weight = 0值的样本数量/1值的样本数量
  
    - max_delta_step
  - 设置weight：如spark初始化DMatrix
  
  

### 参考资料

- [腾讯技术工程-机器学习模型可解释性的详尽介绍](https://www.jiqizhixin.com/articles/2019-10-30-9)
- https://blog.csdn.net/pipisorry/article/details/51788927
- [ROC vs PR曲线](https://www.cnblogs.com/JesusAlone/p/9762352.html)
- [标准化SMOTE采样框架实现与应用](https://mp.weixin.qq.com/s?__biz=MzU0MDkwNTEwNA==&mid=2247485127&idx=1&sn=5d87863616235fc78183bd975549afaf&chksm=fb335d38cc44d42e5937fc55f32a805c382ccc4dceb81effec5006d9fb068d739b3cfca99884&mpshare=1&scene=1&srcid=0923TBh912QlEwnLSlcXUB5E&sharer_sharetime=1569246580110&sharer_shareid=49581f7bdbef8664715f595bc62d7044&key=40244416acac1968edd7318efc6e9c268f3418b1c7de1cb1559c9198d1b763de6e061a14eb84f7ab57b6b095e16d5ca68d2d2b5f7cdbb58e633807ea25142c3050a5c32a8464f0c365f945f162f0af00&ascene=1&uin=MjM1OTMwMzkwMA%3D%3D&devicetype=Windows+10&version=62060833&lang=en&pass_ticket=TiPHQC4Wh5A6AqrSE4OyCRA0nErRaUvNEBSXijdw%2F1Z5NrrfASMX97gm21JRq%2FJw)
- https://github.com/ZhiningLiu1998/awesome-imbalanced-learning

  

