---
layout:     post
title:      数据密集型应用系统设计
subtitle:   第二部分：分布式数据系统
date:       2021-12-08
author:     bjmsong
header-img: img/bigdata.jpeg
catalog: true
tags:
    - 分布式
---
## Chapter5：数据复制
复制
    主从复制：同步复制/异步复制，主/从节点宕机怎么处理，如何新增从节点，复制日志的实现，复制延迟的问题
    多个数据中心：多主复制
- 意义
    - 使得数据与用户在地理上接近（从而减少延迟）
    - 即使系统的一部分出现故障，系统也能继续工作（从而提高可用性）
    - 伸缩可以接受读请求的机器数量（从而提高读取吞吐量）
### 主节点和从节点
- 副本：存储数据库副本的每个节点
- 主从复制/基于主节点的复制
    - 指定某一个副本为主副本。当客户写数据时，必须将写请求首先发送给主副本，主副本首先将新数据写入本地存储
    - 其它副本全部称为从副本。主副本把新数据写入本地存储后，将数据更改作为复制的日志或更改流发送给所有从副本。
    - 客户端从数据库读数据时，可以在主副本或者从副本上执行查询。只有主副本才可以接受写请求，从客户端角度看，从副本都是只读的。
- 同步复制和异步复制
    - 同步复制
        - 主节点需等待从节点确认完成了写入，才会向用户报告完成，并且将最新的写入对其他客户端可见
        - 优点
            - 一旦向用户确认，从节点可以明确保证完成了与主节点的更新同步
        - 缺点
            - 如果同步的从节点无法完成确认，写入就不能视为成功。主节点会阻塞其后所有的写操作，直到同步副本确认完成
        - 半同步
            - 某一个从节点是同步的，而其他节点则是异步的
    - 异步复制
        - 主节点发送完消息后立即返回，不等从节点完成确认
        - 全异步
            - 缺点
                - 如果主节点发生失败且不可恢复，则所有尚未复制到从节点的写请求全部丢失
            - 优点
                - 不管从节点上数据多么滞后，主节点总是可以继续响应写请求，系统的吞吐性能更好
- 配置新的从节点
### 复制滞后问题
### 多主节点复制
### 无主节点复制

## Chapter6：数据分区
### 数据分区与数据复制
### 键-值数据的分区
### 分区与二级索引
### 分区再平衡
### 请求路由

## Chapter7：事务
### 深入理解事务
### 弱隔离级别
### 串行化

## Chapter8：分布式系统的挑战
### 故障与部分失效
### 不可靠的网络
### 不可靠的时钟
### 知识、真相与谎言

## 参考资料
- b站土妹
