---
layout:     post
title:      深度学习推理引擎
subtitle:   
date:       2022-12-09
author:     bjmsong
header-img: 
catalog: true
tags:
    - 模型优化与部署
---
## 概况
- 不支持训练，只关注推理阶段
- 也称为深度学习编译器堆栈
    - 深度学习框架模型文件 -> 不同加速硬件平台
- 用途
    - 解析来自各个深度学习框架的模型文件，转换成统一的计算图级别的中间表示，并可进一步转换成其所支持硬件平台的执行图，提供从框架模型到各种硬件平台的部署能力
    - 基于计算图的中间表示，采用各种优化方法，以提高模型在实际硬件执行过程中的推理性能
- 产品
    - TVM
    - 英伟达：TensorRT
    - 谷歌：TensorFlow XLA
    - Facebook
        - Tensor Comprehensions
        - AITemplate
            - https://ai.facebook.com/blog/gpu-inference-engine-nvidia-amd-open-source/
            - https://github.com/facebookincubator/AITemplate
            - https://mp.weixin.qq.com/s/POMDj0P4-IHVR1y63CKBkQ
    - 阿里：MNN
    https://toutiao.io/posts/8250zb/preview
    https://mp.weixin.qq.com/s/5I1ISpx8lQqvCS8tGd6EJw
    https://mp.weixin.qq.com/s/vc1xQdJJjJT-xoYSPMGshA
    - OpenVINO（Intel CPU）
    https://www.zhihu.com/column/c_1131328261854191616
        - nGraph
    - 小米：MACE
    - 腾讯：NCNN，TNN
    https://blog.csdn.net/weixin_42137700/article/details/107137353
    https://zhuanlan.zhihu.com/p/267272974
    - TNN、Tengine
    https://www.cnblogs.com/LXP-Never/p/14840535.html
    - 字节：LightSeq
    https://mp.weixin.qq.com/s/5VeersQKxcT9AtFXS_CXnA
    - https://zhuanlan.zhihu.com/p/463654311
- DSL -> Deep Learning IR -> LLVM IR -> Target
- 不同推理引擎侧重点不同，且采用不同的抽象层次和优化策略

## 实现功能
- IR
- 图优化

## 参考
- https://openmlsys.github.io/chapter_model_deployment/index.html
- https://zhuanlan.zhihu.com/p/87392811
- https://juejin.cn/post/7055907600071655455
- https://towardsdatascience.com/the-deep-learning-inference-acceleration-blog-series-part-1-introduction-668e39b8b14b
- 公众号：深度学习推理工具链
- https://github.com/HolmesShuan/CNN-Inference-Engine-Quick-View
- https://zhuanlan.zhihu.com/p/519433974

## 阅读开源代码
- NCNN
https://github.com/Tencent/ncnn
https://www.zhihu.com/question/441269200
https://www.bilibili.com/video/BV1Zo4y1R7En/?spm_id_from=333.999.0.0&vd_source=7798c62f92ce545f56fd00d4daf55e26
https://zhuanlan.zhihu.com/p/454835595
- MNN
《MNN: A Universal and Efficient Inference Engine》
- HugeCTR
https://cloud.tencent.com/developer/article/2011186
https://assets-global.website-files.com/61398f0b3344b9d4ec0973b9/6318c6c61dc053b7a51597f0_Merlin%20HugeCTR%20GPU-accelerated%20Recommender%20System%20(1)%20-%20Sara%20Sprinkles%20US.pdf
https://github.com/NVIDIA-Merlin/HugeCTR