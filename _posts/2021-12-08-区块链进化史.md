---
layout:     post
title:      区块链进化史
subtitle:   
date:       2021-12-08
author:     bjmsong
header-img: img/blockchain.jpeg
catalog: true
tags:
    - 区块链
---

>很棒的一本书，彻底更新了我对这个领域的认知。原来区块链背后有这样一段历史：一群技术极客为了保护个人隐私，为了破除中心化极权，前赴后继做了大量的努力和创新，才有了今天如火如荼的区块链。当然，区块链现在的技术还没办法大规模落地，技术极客的理想的乌托邦不一定适合所有人，区块链也可能被很多人利用来达到自己的私欲，但区块链的发展已经是一个不可阻挡的历史趋势。

## 匿名加密货币底层技术
- 非对称加密
	- RSA加密方案
		- 有两个密钥：公钥、私钥
		- 加密效率低
	- PGP（完美隐私）方案
		- 在软件中使用对称加密信息
		- 用非对称加密法加密密钥
	- 密码学历史
		- 古典加密
			- 替换加密法
			- 恩格玛加密机
		- 现代加密
			- 对称加密法
				- DES
			- 非对称加密法
				- 公钥加密，私钥解密
					- A给B发信息，A用B的公钥加密信息，B用自己的私钥解密，就能看到信息了
					- 应用：PGP软件
				- 私钥加密，公钥解密
					- 签名：B给C发消息，B先用自己的私钥签名，然后用C的公钥加密，C收到信息后，先用B的公钥解密，可以确认消息是B发的，然后用C自己的私钥加密，就可以看到信息
					- 应用：区块链转账签名
		- 量子加密
		- 密码朋克宣言
			- 任何中心化的组织和机构都不可信
			- 保护个人隐私只能靠自己，密码学是最有效的工具
			- 通过密码学构建的匿名加密货币是这个体系的基础
- P2P网络
	- 所有计算机节点都是平等的
	- 第一个P2P网站：Napster
	- 网络中心化的问题（不太能认同，这些问题业界都解决的较好了，而且去中心化也不一定能解决这些问题）
		- 中心化服务器权力过大
		- 成本较高
		- 中心化服务器脆弱
- 分布式数据库
	- 去中心化账本：B-money
		- 临时服务器记账：网络上的任何一台计算机都可以充当服务器，都可以记账，多个服务器保存账本副本
			- A给B发送B-money的时候，会在网络上随机选择一些拥有全账本的服务器进行验证，并广播出来让所有服务器保存完整的记账账本


## 第一个电子货币：E-CASH
- 解决“双花”问题、匿名问题
- 中心化系统

## 比特金
- 工作量证明机制：谁做的工作多就轮到谁记账，记账可以得到奖励
	- 共识机制：记账权归谁的机制
- 大多数货币都依赖可信的第三方保障其稀缺性，但是黄金不需要（产量稀少，生成成本高）
- 比特金：兼具黄金和电子货币的特点
	- 黄金：稀缺、生成成本高
	- 电子货币：携带方便，转移方便，分割方便
- 哈希现金来提升生产比特金的难度
	- 哈希：把一段信息运算出固定长度的哈希值（数字指纹），不可逆函数
	- 哈希现金：通过寻找一个随机数的方式，让用户进行大量的计算（挖矿？）
		- 这个随机数和给定的一些参数进行哈希运算，得出的数字指纹必须满足前20位都是0
		- 找到这个随机数的方式只有一种，就是不断尝试
		- 这个随机数就是比特金，它可以和找到这个随机数的参与者的公钥关联起来，进而拥有这个比特金
- 不断延伸的哈希链
	- 一个随机数产生之后，这个随机数就会变成下一个随机数生成的基础
- 网络安全问题：拜占庭将军问题
	- 网络中可能存在欺诈节点和诚实节点，一个网络在正常工作中可以忍耐的欺诈节点越多，说明这个网络的安全机制越好
	- 解决方案: 每个电脑一票
- 稀缺性减弱的问题
	- 随着计算机技术的发展，哈希运算速度越来越快，比特金的生产成本急剧降低
	- 没有很好的解决方案



## 比特币
- 白皮书(2008.11.1发表)
	- 比特币的发行
		- 总量：2100万枚
		- 每隔10min会产生一个区块（数据块），伴随着这个区会产生50个比特币
		- 每隔2016个区块（14天左右）调整一次难度，基本确保10min能产生一个区块
		- 每过4年（21万个区块），每个区块产出的比特币会减半，120年内产生完毕
		- 在一段时间内，选择一台普通的节点充当服务器进行记账，它记账完后会把这段时间发送的账单打包成一个数据块在全网进行广播
		- 每一个比特币还可以切分到小数点后8位
	- 比特币的转移
		- 点对点：用户对用户，不需要服务器
		- 中心化金融机构存在的问题：
		1. 实现不了不可逆的交易：银行可以撤销任何一笔交易，存在着欺诈的可能性
		2. 无法实现小额低成本转账：中心化机构成本较高
		- 比特币系统实现不可逆交易：Unspent Trasaction Output(UTXO,未花费的交易输出)
	- 其它：时间戳服务器、工作量证明、网络、激励、回收硬盘空间、简单交易验证等
- 代码开源(C++)
	- 任何人都可以修改源代码，发行"山寨币"
	- 任何人都可以下载比特币软件并在自己电脑上运行，称为比特币网络中的一个节点
- 比特币2009.1.4诞生，但是直到2020.6，都没太多关注
- 门头沟交易所
	- 中心化的解决方案：现金和比特币都在交易所的账户里面
	- 遭遇黑客攻击
	- 2014.3破产
- 地下网站"丝路"
	- 匿名交易的亚马逊：ip地址、交易痕迹、包裹地址都得到隐藏
- 挖矿
	- 区块生产者通过算力进行竞争的过程：每个计算机都把上一个区块的数字指纹和一个随机数进行哈希计算，如果结果满足要求则是找到了正确的随机数，如果结果不符合要求就更换随机数。最先找到正确随机数的计算机就被确定为合法的区块生产者，可以产生区块，同时获得区块奖励的比特币，以及本区块内所有交易的手续费。
		- 转账费用逐渐成为矿工的主要收入
		- 转账费不固定，费用越低，转账速度会越慢
	- 竞争的本质就是算力竞争，挖矿的过程就是整个网络算力不断提高的过程
	- 算力：一秒钟进行哈希运算的次数
	- 挖矿机进化
		- CPU
		- GPU：可以实现数百线程的整数运算
		- FPGA：定制矿机
			- 比特大陆：经历寒冬后胜出
		- 矿池：联合挖矿，挖到的比特币按照算力进行分配，从而让矿工的收益趋于稳定，减少风险
			- BTC矿池、蚂蚁矿池、鱼池、Poolin、Slushpool
	- 矿工在产业链最低端，矿机生产厂家占据主导地位
	- 消耗大量电
- 比特币区块链：一条由一个个的区块按照时间顺序组成的链条，随着时间的推移不断延伸
	- 比特币网络中的每个计算节点上都有一条链
	- 不可篡改性：只有在同一时间把全网51%以上节点的数据改掉才有可能篡改区块链数据
		- 显著优于中心化网络
	- 最长链原则
- 比特币区块链分叉
	- 软分叉：算力最终集中在一条链上
	- 硬分叉：算力最终分散到两条链上
		- 很多山寨币就是从比特币网络上分叉出来的
		- 第一个：比特现金
			- 新生成的8MB区块的链
- 每秒处理的交易数量(TPS):6.8笔(理论)，3~4笔(实际)
	- 解决方案
		- 区块扩容
		- 隔离见证+闪电网络
- 闪电网络
	- 链外扩容，把很多信息放到比特币区块链之外
	- 智能合约：即支付通道，当双方进行交易的时候，可以通过这个自动执行的代码从锁定的资产库中直接交易
	- 速度快，保护隐私，转账成本低，适合于小额高频交易
	- 是比特币在日常生活中使用的最有效的方案之一

## 区块链
- 用来描述比特币使用的底层技术
- 比特币是区块链的代表，还有以太坊、EOS等
- 区块链参数
	- 区块头
	- 区块体
	- 创始区块
	- 区块大小：1M
	- 出块时间：10min
	- 时间戳
	- 挖矿奖励：50TC/区块
- 区块的分类
	- 公有链：公开软件供人使用
	- 联盟链：有明显接入权限的区块链
		- 区块链技术在银行业最受环境，应用也最多
	- 私有链
	- 1.0：货币类应用，例如比特币
	- 2.0：智能合约类应用，例如以太坊
	- 3.0：会深入到各个行业，例如EOS、Filecoin

## 山寨币：在比特币源码基础上开发的
- 莱特LTC：对比特币进行了改良
- 大零Zcash：妖币
- 狗狗通证：开玩笑的，跟比特币反着来

## 以太坊 
- V神
- 比特币：去中心化的匿名加密货币
- 以太坊：区块链世界的第一个操作系统
	- 为了实现“智能合约”
	- 最核心的模块是“以太坊虚拟机”，它本质上就是一个计算机，可以执行各种"智能合约"
		- 每个以太坊节点都有一个一模一样的虚拟机，它们会共同执行智能合约，并且相互校验，以保证代码的必然执行
- 以太坊参数
	- 区块大小：800W GAS
		- 以消耗的资源来衡量
		- 最多380笔交易，实际每秒十几笔，效率比比特币高（离实际应用还远）
		- 在以太坊系统上执行任何操作都需要支付一定的费用，就是燃料GAS
		- 开发人员需要给燃料报价，只有价格合适了才会有矿工帮忙打包，也就是才能在以太坊上运行自己的程序
		- 开发人员还需要制定最大的燃料限额，如果已经达到限额还没有完成程序的话，就不再执行，退回初始状态，而已经花掉的费用也不退回了
	- 挖矿奖励：1560W/年
		- 以太坊的总体数量是按照众筹出售的以太坊的数量来确定的
		- 每个区块一开始奖励5个以太坊，后来更改为3个以太坊，最终还会过渡到POS机制，有一个动态调整的过程
	- 出块时间：15s
		- 如果区块内存储的交易数量相同的话，出块时间越短，效率越高，能记录的交易也就越多
		- 受限于网络时延（中国和美国的网络时延时200~300毫秒），出块时间也不能无限短
		- 已经产生了一些问题，比如孤块：两个矿工都找到了随机数，且都广播了自己挖出的区块，本质上这两个区块都是合法的，不过因为网络问题，有的区块更早达到大多数节点，其余的区块就是孤块
- 空气通证
	- 没有区块链项目的通证，"代替通证"
	- 可以为很多正在开发的项目募资，例如大名鼎鼎的EOS(成功募资50亿美金)
- 智能合约是程序代码，有如下特性：
1. 代码即法律
2. 机器信任
3. 功能相对弱
4. 外部数据交互难度大
- The DAO：去中心化组织，Decentralized Autonomous Organization
	- 导致以太坊社区分化

## EOS
- DPOS共识机制
- 总募资43亿美元
- 和以太坊是竞争关系，易用性上比以太坊有了一些提升，采用了不同的虚拟机，可以直接使用C++编程	

## IPFS
- http
	- 超文本传输协议，本质上是一组存储文件、寻找文件、展现文件的协议，规定了服务器和客户端之间的文件传输规范
	- 存在的问题
		- 网络安全得不到保障：服务器作为网络中心会面临各种风险
		- 网络效率不够高
		- 很难保护数据隐私
		- 全网文档管理混乱
- IPFS：全称为星际文件系统，是一组文件管理协议，去中心化的文件存储方式
	- 一份文件不用全网都保存就能实现不可篡改，存储效率更高
- 四层模型：P2P网络层，IPFS协议层，Filecoin激励层，应用层
- Filecoin






