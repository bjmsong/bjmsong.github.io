---
layout:     post
title:      PyTorch
subtitle:   
date:       2022-09-20
author:     bjmsong
header-img: img/dl/pytorch.jpg
catalog: true
tags:
    - 深度学习框架
---
## https://pytorch.org/tutorials/beginner/basics/intro.html
- 使用Microsoft Learn，体验不错
- tensor：基本数据单位
- torch.utils.data.DataLoader，torch.utils.data.Dataset：数据集加载与处理
- torch.nn: 搭建神经网络
- torch.autograd: 自动微分，更新参数
- 优化模型参数
- inference
    - Optimizing a models to run on a variety of platforms and programming languages is difficult. It's very time consuming to maximize performance across all the different combinations of frameworks and hardware. The Open Neural Network Exchange (ONNX) runtime provides a solution for you to train once and acelerate inference on any hardward, cloud or edge devices is needed.
    - ONNX is a common format supported by a number of vendors to share neural networks and other machine learning models. You can use ONNX format to do inference on your model on other programming languages and frameworks such as Java, JavaScript, C# and ML.NET

## https://pytorch.org/tutorials/beginner/deep_learning_60min_blitz.html

## Key Feature
https://pytorch.org/features/
- Production Ready
- TorchServe 
- Distributed Training
- Mobile(EXPERIMENTAL)
- Robust Ecosystem
- NATIVE ONNX SUPPORT
- C++ FRONT END
- Cloud Support

## Pytorch 2.0
- 主要feature是引入torch.compile：通过编译的方式，用一行代码实现模型的稳定加速。
- https://www.zhihu.com/question/570220953?utm_campaign=Sharon&utm_medium=social&utm_oi=30249563717632&utm_psn=1582429066912780288&utm_source=wechat_session&utm_content=group3_supplementQuestions
- https://pytorch.org/get-started/pytorch-2.0/
- https://mp.weixin.qq.com/s/NzmUphWdQDemu-sWwh4vTg
- https://www.bilibili.com/video/BV1p84y1675B/?spm_id_from=333.337.search-card.all.click&vd_source=7798c62f92ce545f56fd00d4daf55e26

## API
- python
https://pytorch.org/docs/stable/index.html
- C++(LibTorch)
https://pytorch.org/cppdocs/
  - ATen: The foundational tensor and mathematical operation library on which all else is built.
  - Autograd: Augments ATen with automatic differentiation.
  - C++ Frontend: High level constructs for training and evaluation of machine learning models.
  - TorchScript: An interface to the TorchScript JIT compiler and interpreter.
  - C++ Extensions: A means of extending the Python API with custom C++ and CUDA routines.
- https://www.youtube.com/watch?v=RFq8HweBjHA&ab_channel=AlanTessier
  - https://github.com/alantess/learntorch

## CUSTOM EXTENSIONS
- C++ AND CUDA
https://pytorch.org/tutorials/advanced/cpp_extension.html
https://github.com/pytorch/extension-cpp.git
https://github.com/pytorch/pytorch/tree/master/test/custom_operator
https://zhuanlan.zhihu.com/p/350651297
https://blog.csdn.net/weixin_44966641/article/details/125609129
https://developer.aliyun.com/article/978287
https://zhuanlan.zhihu.com/p/46991210
https://zhuanlan.zhihu.com/p/48463543
- Python
https://pytorch.org/docs/master/notes/extending.html

## Pytorch JIT
### Research to Production: PyTorch JIT/TorchScript Updates 
- https://www.youtube.com/watch?v=St3gdHJzic0&ab_channel=PyTorch
- A compiler and language infrastructure for machine learning
- production requirements
  - portability
  - performance 
- 两个组件
  - Torchscript： capture the structure of pytoch programs
    - a static(静态类型) subset of python language speciallized for machine learning
  - Jit compiler: use that structure to optimize
### https://github.com/pytorch/pytorch/blob/master/torch/csrc/jit/OVERVIEW.md#jit-technical-overview

## torch.fx
- EASY PYTHON CODE TRANSFORMATION WITH TORCH.FX | JAMES REED
  - https://www.youtube.com/watch?v=fbtVDqp3lv8&ab_channel=PyTorch
  1. why program transformations?
    - Pytorch's Python-based API is great for code authoring
    - But sometimes we want to use the code in a different way than it was authored
      - model quantization
      - optimization
      - accelerator device lowering
    - Would like a system to modify the code after it has already been authored 
    - 目前有两种方案
      - swap nn.Module instance
      - TorchScript
        - 主要用来部署
        - complicated representation, hard to use. Built for compiler engineers. 
  2. why torch.fx
    - Provide a system that enables tranformation of PyTorch code after it has been written. It should follow these principles:
      - Python-native: Consumes Python programs, APIs all Python, produces Python programs
      - Simple to use: Simplified program representation and APIs. Emphasize DAG nature of netural network
      - Lightweight: Don't need to learn, use, or compile C++, can use it just by installing Pytorch and writing Python 
  3. torch.fx in a nutshell
    - 3 componets
      - symbolic tracing
        - control flow 不支持
      - intermediate representation(IR)
        - a DAG that encodes the operations in the program: nodes are operations, edges are values
        - graph has convenient manipulation APIs to add remove,re-order,or replace opeartions
      - python code generation
  4. use case study
    - FX-based Quantizaiton Tool
    - Optimizations: Fusion, Opeartion Scheduling
    - Device Lowering
- https://pytorch.org/docs/stable/fx.html
- https://mp.weixin.qq.com/s?__biz=Mzg3ODU2MzY5MA==&mid=2247488884&idx=1&sn=09c240165c0bdb4f7650e9bf2ca45d74&chksm=cf108d71f867046704b4a674882bb01d797d3c6aa5aed66b98966b9e65fb98d70aeee2383118#rd
- 《TORCH.FX: PRACTICAL PROGRAM CAPTURE AND TRANSFORMATION FOR DEEP LEARNING IN PYTHON》
  - https://zhuanlan.zhihu.com/p/449908382

## pytorch hub
- 官方模型库（Model Zoo）

## Torchvision
https://www.youtube.com/watch?v=CU6bTEClzlw&ab_channel=PyTorch

## 论坛
https://discuss.pytorch.org/

## Pytorch VS TensorFlow
- https://www.zhihu.com/question/322651220
  - https://www.assemblyai.com/blog/pytorch-vs-tensorflow-in-2022/
- https://www.zhihu.com/question/526092590
- https://www.zhihu.com/question/452749603
- https://trends.google.com/trends/explore?date=today%205-y&geo=US&q=pytorch,tensorflow

## lightning
- https://www.youtube.com/watch?v=zMO9itSbFxQ&ab_channel=PyTorch
- https://github.com/Lightning-AI/lightning
- https://zhuanlan.zhihu.com/p/353985363
- https://zhuanlan.zhihu.com/p/370185203
- https://zhuanlan.zhihu.com/p/492703063
- https://www.pytorchlightning.ai/
- https://www.reddit.com/r/MachineLearning/comments/qgqq07/d_is_pytorch_lightning_production_ready

## 其它
- https://github.com/yunjey/pytorch-tutorial
- fast.ai
https://docs.fast.ai/
https://github.com/fastai/fastai
https://arxiv.org/pdf/2002.04688.pdf
- https://github.com/bharathgs/Awesome-pytorch-list