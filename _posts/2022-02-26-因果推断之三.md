---
layout:     post
title:      因果推断之三
subtitle:   
date:       2022-02-26
author:     bjmsong
header-img: img/
catalog: true
tags:
    - 因果推断
---
## 互联网公司应用
https://mp.weixin.qq.com/s/sKG311LfcHCTq-LrSTv-OA
https://mp.weixin.qq.com/s/XETtP9IefIhK1vgcJtZNhQ
https://mp.weixin.qq.com/s/AVYxvGJLM3d0EvJjEXBfFg

https://mp.weixin.qq.com/s/AVYxvGJLM3d0EvJjEXBfFg?st=C6C1AAA6B611DC893CB441F4155D4BF00C0AA12ABD76B3D0F04A9876CC94549E33C39015F72E9FB1EF1AB2274D8EA338558768C97B98719AC81D2E4C8D040618C5E66CB011C33CA92F2988BC2C7E7E90547EB16C30B82D08DC32A8D96D307420AC78D4AE9C7722FB5BD7D12E818EBC1D1E0361867310AD8B1E962FFC764D8B9FEC5835F92D3FD62282E10A236FEDB41DD66086F81182113481EF136899A36F1422759607B52B46B90DF324A6882D76850B65880CDC7694722D96D51CA7CDC685C5CB4DC1C8F4C4552E02140B4D1B21F3&vid=1688853122621728&cst=A7E0C087E7AD74558022FA59D5B26901326C4FEAFA4910707AEF870F961BD373610E206558E95C16F1382D4B84B0F612&deviceid=4da41b25-b5b2-4aa3-bcea-53f2aefa4079&version=4.0.0.90438&platform=mac
https://mp.weixin.qq.com/s/XETtP9IefIhK1vgcJtZNhQ?st=6AFBB9AE6D112F6C4576B97EB6E38CBD4D706B2D5829A1195508C1C599C43AD6DF49D477A8977DA773CB40BDC6D96A60504E03F2CFF44031B2363442B05C5A582DB3C7A926816907B29F7C3854412BB287FD2174EF5B4149B5F3016B6A6C2D07762E4DD4BED5A53DA12BACF7AF1277D34AD6DD53029FFB6013800CDDFE92F413FA12F34D7BF7C57EF9300A848390454DE069BA76D7AC710FEC5081EBB18951F3A6946EA0A326DB995FFC5288D311D4066BE0D8DDB1993E426BF6E7217DAA80D71E9F9E05FF4626F8CD0F021DFE16FF05&vid=1688853122621728&cst=E2CFE37267316FF16FA1D04478306AFDC498BCB961FDEF55EC044DC2DA366CB5B8EF2D813A20C3D29617FF8B6359692C&deviceid=4da41b25-b5b2-4aa3-bcea-53f2aefa4079&version=4.0.0.90438&platform=mac
https://mp.weixin.qq.com/s/sKG311LfcHCTq-LrSTv-OA?st=8F6EE5FFC77CD356DE18DA1B8D19FB004242263511B757E4EC7756BF5B940149B3D50463B1C48255C28517DA171391724520241271A61F3C3D2351A1FCC8DA201EBCBFBAAA4199D3BF27F671C4558A39E8A9417B5096E3781F3D04AD5BE4252D4E4936DCE34B47A5655FDE0D1FE5CEFD2EA635ADA1EB38EFDC59B4E9DF72FA616B0F06C3FA71D83B6920EF60987A236CEA0B10C9C42DABED79C75579563D83789070CD18E99E93FA2FB1424C568ACE5ED6725F4BE29870C4247A8F3EB2BDBE9EC0A001ECAED89BC76B2D37A7A7703221&vid=1688853122621728&cst=C9C60BF864157989A1BCABEE5F641321A40836C8985C16F6D8669F10DA0552916E9700B7634ADCEB2980D33348C1ED5C&deviceid=4da41b25-b5b2-4aa3-bcea-53f2aefa4079&version=4.0.0.90438&platform=mac

## Blog by Shawhin Talebi
### 1.Causality: An Introduction
- https://towardsdatascience.com/causality-an-introduction-f8a3f6ac4c4a
- 传统统计学的三个陷阱
    - Correlation Does Not Imply Causation：spurious correlation is a statistical correlation with no causal implications
        - 一个国家巧克力的消费 & 得诺贝尔奖的人数
    - 所谓的“辛普森悖论”：相同的数据得到了相反的结论
        - 其实只是没有掌握事情的全貌（仅仅看到了整体数据和切分后数据不一致），盲人摸象而已。如果仔细分析因果关系，“悖论”迎刃而解
    - 对称性：causality is fundamentally asymmetric i.e. causes lead to effects and not the other way around
- Causality
    - X causes Y if an intervention in X results in a change in Y, while an intervention in Y does not necessarily result in a change in X
- Causality is represented mathematically via Structural Causal Models
    - graph：DAG
    - set of equations：Structural Equation Model (SEM)
- Causal discovery 
    - aims to uncover causal structure from observational data
- Causal inference
     - answer questions based on the causal structure of the problem
- causality is still a young field with several open problems.

### 2.Causal Inference：Answering causal questions with Python
- https://towardsdatascience.com/causal-inference-962ae97cefda
- 3 Gifts of Causal Inference
    - Gift 1: The do-operator
        - do-operator is a mathematical representation of a physical intervention
        - The power of do-operator is that it allows us to simulate experiments
        - do-calculus can translate interventional distributions (i.e. probabilities with the do-operator) into observational distributions (i.e. probabilities without the do-operator)
        - rules of do-calculus
        - The do-operator is a key tool in the causal inference toolbox
    - Gift 2: Deconfounding Confounding
        - confounding is anything that leads to P(Y|X) being different than P(Y|do(X))
    - Gift 3: Estimating Causal Effects
- concrete example of using Python to do causal inference
    - DoWhy是微软开发的一个用于因果推断的python库，旨在引发因果关系思考和分析。DoWhy结合了图模型和潜在结果模型这两个主要框架，为因果推断方法提供了统一的界面，并自动测试了许多假设，从而使非专业人员可以进行推断
    - the starting point of all causal inference is a causal model



### 3.Causal Discovery：Learning causation from data using Python
- https://towardsdatascience.com/causal-discovery-6858f9af6dcb
- Causal discovery aims to infer causal structure from data
- There is no standard causal discovery method out there. In fact, there is a wide assortment of techniques available
- 4 Common Assumptions of Causal Discovery
    - Acyclicity — causal structure can be represented by DAG (G)
    - Markov Property — all nodes are independent of their non-descendants when conditioned on their parents
    - Faithfulness — all conditional independences in true underlying distribution p are represented in G
    - Sufficiency — any pair of nodes in G has no common external cause
- 3 Tricks for Causal Discovery
    - Trick 1: Conditional Independence Testing
    - Trick 2: Greedy Search of Graph Space
    - Trick 3: Exploiting Asymmetries


## 什么是因果推断Causal inference？为什么数据科学家要知道这个？ & 读书会
- by Youtube Data Application Lab
- 《causal inference what if》
- 因果推断之前在经济学领域应用很广，目前在硅谷大厂越来越火
    - 2019年之前，在互联网公司应用很少，因为绝大多数的因果推断都可以通过AB实验来完成
    - 但是很多情况AB实验很难设计，很难评估
        - 长期（long-term）的影响
        - 比如微信的“炸屎”功能对于微信的DAU有什么影响（社交网络公司这类问题很典型）
            - 如果基于用户随机分组，但是万一有“炸屎”功能的用户向没有“炸屎”功能用户发送“炸屎”，咋办？
            - 如果基于时间分组，可能前后两段时间有其它差异（比如后面一段时间包含春节），没法直接比较
        - 其它行业case更多，很多东西无法control
            - ethical（伦理） reasons： 随机分组让人抽烟，来研究对肺癌的影响 
            - infeasible（不可行）：把国家随机分组到社会主义/资本主义，来研究体制对GDP的影响
            - impossible：调整一个人的DNA，来看对乳腺癌的影响 

### causal effect：因果效应
- individual causal effect
- we compare(usually only mentally) the outcome when an action A is taken versus the outcome when the action A is withheld. If the two outcomes differ, we say that the action A has a causal effect, causative or preventive, on the outcome. Otherwise, we say that the action A has no causal effect on the outcome. Action A offen refers as an intervention, an exposure, or a treatment. 
- potential outcome / counterfactual outcome: 所有可能的treatment和结果之间的pair 
- average causal effect: 衡量群体的因果效应
- causation versus association
    - association Does Not Imply Causation
    - if treatment A and outcome Y are independent: association equals to Causation
    - independent: the proportion of individuals who develop the outcome in the treatment euqals the proportion of individuals who develop the outcome in the untreatment

### 随机实验
- 得出因果最直接的方式，最准确的标准，golden standard
    - 药物上市前做的二期、三期临床都是随机实验
- 其它的办法都会有一些trade-off，有些bias无法消除
- 条件随机(Conditional randomization)
    - 基于某个条件分组，然后再随机分组
- 标准化
- 逆概率加权

### Observational studies: 观察性研究
- 不需要随机实验，通过已有的数据来分析因果效应
- an Observational study can be conceptualized as a conditionally randomized experiment if the following conditions hold:
    - well-defined treatment：例如可以用0，1来表示treatment
    - the conditional probability of receiving every value of treatment,though not decided by the investigators, depends only on measured covariates
    - the probability of receiving every value of treatment conditional on is greater than zero
- 互换性
- 正定性



## 参考资料
- 《Causal Inference for the Brave and True》 
    - 难度比较适中，不仅仅是科普，但也比那些上来就讲半参理论的要好懂很多
- DataFun X 集智俱乐部：因果推断在工业界的应用
https://appukvkryx45804.pc.xiaoe-tech.com/detail/l_62403d13e4b04e8d9027f5b7/4?fromH5=true
- https://pattern.swarma.org/article/145
- https://www.bradyneal.com/which-causal-inference-book
- 微信公众号：集智俱乐部，因果科学
- 《倾向值分析:统计方法与应用》
- edx 《Causal Diagrams: Draw Your Assumptions Before Your Conclusions》
- https://www.zhihu.com/people/delight/answers
- 其它公开课
https://www.zhihu.com/question/410413388
- https://medium.com/data-science-at-microsoft/causal-inference-part-1-of-3-understanding-the-fundamentals-816f4723e54a
- https://medium.datadriveninvestor.com/goodbye-correlation-say-hello-to-the-era-of-causal-inference-f238065c156b
- https://towardsdatascience.com/causal-inference-962ae97cefda
- https://zhuanlan.zhihu.com/p/403098221
- https://zhuanlan.zhihu.com/p/409609129
- 《An Introduction to Causal Inference》 Judea Pearl
- https://www.zhihu.com/question/479067450/answer/2233738800
- https://mp.weixin.qq.com/s/AVYxvGJLM3d0EvJjEXBfFg
- uplift model
https://towardsdatascience.com/uplift-modeling-e38f96b1ef60
https://mp.weixin.qq.com/s/HFMuntBwuZURl60j3ZmdZQ
https://blog.csdn.net/alienttech/article/details/104547997/
https://www.slideshare.net/search/slideshow?searchfrom=header&q=uplift+model
https://blog.csdn.net/jinping_shi/article/details/105583375
https://medium.com/@Minyus86/causallift-python-package-for-uplift-modeling-in-real-world-business-e60264812a26
https://github.com/uber/causalml
https://www.thedatalab.com/tech-blog/understanding-customer-behaviour-using-uplift-modelling/
https://www.uplift-modeling.com/en/latest/
https://towardsdatascience.com/beyond-churn-an-introduction-to-uplift-modeling-d1d9af7be
https://towardsdatascience.com/a-quick-uplift-modeling-introduction-6e14de32bfe0
https://en.wikipedia.org/wiki/Uplift_modelling