---
layout:     post
title:      GPU
subtitle:   
date:       2022-09-02
author:     bjmsong
header-img: 
catalog: true
tags:
    - 模型优化与部署
---
## https://www.quora.com/Why-are-GPUs-well-suited-to-deep-learning
- High bandwidth main memory
- Hiding memory access latency under thread parallelism
- Large and fast register and L1 memory which is easily programmable are the components which make GPUs so well suited for deep learning

## https://www.bilibili.com/video/BV1NB4y1L7R8?spm_id_from=333.880.my_history.page.click&vd_source=7798c62f92ce545f56fd00d4daf55e26
- GPU选型
    + 服务器：DGX A100
        * 15000美金\*8块卡
        * 8快A100
        * 算力（单卡）：320TFLOPS
        * 显存：640GB(8块卡，每块卡80GB)
        * GPU之间双向带宽：600GB/s
            - 增加GPU之间带宽: NVLink 
    + 云服务器
    + 游戏显卡：GeForce 3090 Ti
        * 显存：24GB
        * 带宽：1TB/s
        * 算力
            - 单精度浮点运算：33TFLOPS
            - 半精度浮点运算，使用tensor core：160TFLOPS


## GPU云服务器：按小时计费，不要忘记关机
- AutoDL
    + 扫码添加客服微信，邀您加入用户群不定时发放福利
    - https://www.autodl.com/home
    - 实例中的数据（包括环境）在关机后将全部保存，开机后无需再次配置和上传数据。总而言之，实例在数据在，但是连续关机30天实例将被释放
    - 选择CPU
        + 尽管CPU并不直接参与深度学习模型计算，但CPU需要提供大于模型训练吞吐的数据处理能力
        + 每块GPU应配备至少4~8核心的CPU，以满足多线程的异步数据读取
        + 分配更多的核心通常不会再有很大的收益，此时的数据读取瓶颈通常源于Python的多进程切换与数据通信开销（如使用PyTorch DataLoader)
            * NVIDIA DALI数据读取加速库：单核CPU实例的数据读取能力超过了基于Python的八核心实例
    - 选择GPU
    - 性能问题排查
        + https://www.autodl.com/docs/perf/
    - 省钱妙招
        + https://www.autodl.com/docs/save_money/
    - 其它
        + https://zhuanlan.zhihu.com/p/562635652
    - 机器配置
        + GPU
        + CPU
- Colab：免费，要翻墙
    + https://zhuanlan.zhihu.com/p/56374118
    + 自带google的大量代码 
    https://www.zhihu.com/question/299434830
    https://zhuanlan.zhihu.com/p/54389036
    https://towardsdatascience.com/superpower-your-google-colab-720d54dd6a06
- AWS
    + Tesla t4 0.5美元/小时
    + https://www.bilibili.com/video/BV1MA411L78X/?spm_id_from=333.788&vd_source=7798c62f92ce545f56fd00d4daf55e26
- 其它
https://www.zhihu.com/question/271520755
https://mp.weixin.qq.com/s/cut23I5y9ChIey4ZeIDO8w
https://www.zhihu.com/question/371315056
https://zhuanlan.zhihu.com/p/519533121


## 服务器CPU
- CPU核心参数
    + 主频
    + 总线频率：影响CPU与内存数据交换的速度
    + 缓存
- CPU性能指标
    + 核心数量
        * 核心（内核、物理核心）：1-64个
    + 线程数量
        * 超线程：线程数量可以多于核心数量
    + 内存规格
    + 封闭规格
    + 制造工艺
- x86
    + Intel
        * 家用：赛扬<奔腾<酷睿
        * 服务器：志强(xeon)
    + AMD
        * 家用：锐龙(Ryzen)
        * 服务器：霄龙(EPYC)，皓龙
- 服务器CPU
    + 支持ECC内存
    + 多路运算：2个及以上CPU
    + 核心数量多
        * 需要充分利用多核心的性能，否则无法发挥服务器CPU的性能
    + 主频较低
- 家用CPU
    + 不支持ECC内存
    + 单路运算：1颗CPU
    + 核心数量少
    + 主频较高
- 服务器CPU天梯图
    + http://www.cpuxn.com/tianti/Xeontianti.html