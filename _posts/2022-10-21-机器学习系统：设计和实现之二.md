---
layout:     post
title:      机器学习系统：设计和实现
subtitle:   之二
date:       2022-10-21
author:     bjmsong
header-img: 
catalog: true
tags:
    - ML System
---
## 4.计算图
### 计算图的设计背景和作用
- 随着机器学习的进一步发展，模型的拓扑日益复杂（包括混合专家，生成对抗网络，多注意力模型）。这些复杂的模型拓扑结构（例如：分支结构，带有条件的if-else循环）会影响模型算子的执行、自动化梯度计算（一般称为自动微分）以及训练参数的自动化判断。为此，我们需要一个更加通用的技术来执行任意机器学习模型，计算图应运而生。
- 作用
    - 对于输入数据、算子和算子执行顺序的统一表达
        - 机器学习框架用户可以用多种高层次编程语言（Python，Julia和C++）来编写训练程序，计算图可以作为一个统一的数据结构来表达用户用不同语言编写的训练程序
    - 定义中间状态和模型状态
        - 通过计算图，机器学习框架可以准确分析出中间状态的生命周期（一个中间变量何时生成，以及何时销毁），从而帮助框架更好的管理内存
    - 自动化计算梯度
        - 计算图的出现让自动化分析模型定义和自动化计算梯度成为可能
    - 优化程序执行
        - 通过利用计算图来分析模型中算子的执行关系，机器学习框架可以更好地发现将算子进行异步执行的机会，从而以更快的速度完成模型程序的执行

### 计算图的基本构成
- 计算图是用来表示深度学习网络模型在训练与推理过程中计算逻辑与状态的工具。计算框架在后端会将前端语言构建的神经网络模型前向计算与反向梯度计算以计算图的形式来进行表示。
- 计算图构成
    - 基本数据结构：张量(Tensor)
    - 基本运算单元：算子(Operator)
- 通常使用节点来表示算子，节点间的有向线段来表示张量状态，同时也描述了计算间的依赖关系
- 数据流将根据图中流向与算子进行前向计算和反向梯度计算来更新图中张量状态，以此达到训练模型的目的
- 张量属性
    - 形状
    - 维度
    - 数据类型
    - 存储位置：CPU、GPU
    - 名字
- 

### 计算图的生成
- 

### 计算图的调度
- 


## 6.编译器前端
- 


## 7.编译器后端和运行时(Runtime)
- 


## 8.硬件加速器
- 


## 9.数据处理框架
- 


## 10.模型部署
- 


## 11.分布式训练
- 


## 


## 参考资料
- https://openmlsys.github.io/
- https://zhuanlan.zhihu.com/p/484878657