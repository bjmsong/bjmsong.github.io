---
layout:     post
title:      Pytorch
subtitle:   
date:       2019-09-16
author:     bjmsong
header-img: img/dl/pytorch.jpg
catalog: true
tags:
    - 深度学习
---
>基于python的深度学习包，可以支持深度学习算法，最大化利用GPU。

### Tensor
类似NumPy的ndarrays，所不同的是Tensor可以利用GPU加速。
#### 创建Tensor
构建Tensor的方法很多，可以指定Tensor大小
```
x = torch.empty(5, 3)
x = torch.rand(5, 3)
x = torch.zeros(5, 3, dtype=torch.long)
```
也可以从已有数据中构建

```
# list
x = torch.tensor([5.5, 3])
# Tensor
x = x.new_ones(5, 3, dtype=torch.double)
x = torch.randn_like(x, dtype=torch.float)
```

#### 操作Tensor
同一种操作有多种写法，例如加法：
```
y = torch.rand(5, 3)
print(x + y)
print(torch.add(x, y))
# 指定加法结果
result = torch.empty(5, 3)
torch.add(x, y, out=result)
# 原地加
y.add_(x)
```
切片操作和numpy一样
```
print(x[:, 1])
```
改变Tensor的维度
```
x = torch.randn(4, 4)
y = x.view(16)
z = x.view(-1, 8)  # the size -1 is inferred from other dimensions
print(x.size(), y.size(), z.size())
```
Tensor和ndarray的交互非常方便
```
# to Tensor
a = numpy.array([1, 2, 3])
t = torch.from_numpy(a)
# to ndarray
a = torch.ones(5)
b = a.numpy()
```

[Tensor操作API手册](https://pytorch.org/docs/stable/torch.html)

#### CUDA
CUDA（Compute Unified Device Architecture），是显卡厂商NVIDIA推出的运算平台。CUDA™是一种由NVIDIA推出的通用并行计算架构，该架构使GPU能够解决复杂的计算问题。
使用.to方法可以将Tensors移动到任意平台进行运算
```
# let us run this cell only if CUDA is available
# We will use ``torch.device`` objects to move tensors in and out of GPU
if torch.cuda.is_available():
    device = torch.device("cuda")          # a CUDA device object
    y = torch.ones_like(x, device=device)  # directly create a tensor on GPU
    x = x.to(device)                       # or just use strings ``.to("cuda")``
    z = x + y
    print(z)
    print(z.to("cpu", torch.double))       # ``.to`` can also change dtype together!
```

### 参考资料
- https://pytorch.org/tutorials/
- https://course.fast.ai/
- code
    - https://github.com/yunjey/pytorch-tutorial
    - https://github.com/MorvanZhou/PyTorch-Tutorial
