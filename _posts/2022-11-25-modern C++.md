---
layout:     post
title:      modern C++
subtitle:   
date:       2022-11-25
author:     bjmsong
header-img: 
catalog: true
tags:
    - C++
---
- 写起来更舒服，降低程序员的心智负担
- 程序更安全
- 优化编译的过程和项目的构建
- 更容易写出高性能的C++

- https://changkun.de/modern-cpp/
- Effective Modern C++
    https://book.douban.com/subject/25923597/
    https://github.com/BartVandewoestyne/Effective-Modern-Cpp


## 10个现代C++新特性：奇乐编程学院
https://www.bilibili.com/video/BV1AX4y1u7ez/?spm_id_from=333.788.recommend_more_video.2&vd_source=7798c62f92ce545f56fd00d4daf55e26
- 委托构造函数 (Delegating Constructors) 
- 类内初始化 (In-Class Initializer)
- 空指针 (nullptr)
- 枚举类 (enum class)：enum class
- 类型推导 (Type Inference)：auto
- 常量表达式 constexpr ： 将运行时的计算提前到编译时来做性能优化
- 初始化列表 (Initializer List) 
- 基于范围的 for 循环 (Range-Based For-Loops)
- 智能指针之 unique_ptr 
- Lambda 表达式 (Lambda Expression) ：匿名函数


## C++11(2.0)新特性 from 侯捷
- https://www.youtube.com/watch?v=4HZpY7X9RG4&list=PLRTJhCIMo8HM16EbfTa4IgvwgLbj5z_9M&ab_channel=%E6%90%9E%E6%B8%B8%E6%88%8F%E7%9A%84%E5%B0%8F%E6%9D%A8%E5%93%A5
### 语言
- Variadic Templates：数量不定的模板参数
    - 可以很方便地完成recursive function call：例如hash函数
    - 可以很方便地完成recursive inheritance：例如tuple类
- The requirement to put a space between two closing template expressions has gone

```C
vector<list<int> >  
vector<list<int>>  // ok, since C++ 11
```

- nullptr
    - 取代NULL
    - avoid mistakes that occurred when a null pointer was interpreted as an integral value
- auto: Automatic Type Deduction
- Uniform Initialization
    - 
- Initialization List
- Range-based for statement
- =default,=delete
- Type Alias
- using
    - using-directives for namespaces and using-declarations for namespace members
        - using namespace std;
        - using std::count;
    - using-declarations for class members
    - type alias and alias template declaration
- noexcept
- override
- final

### 标准库
- 标准库源代码
- Rvalue references(右值引用) and move semantics(移动语义)
    - Rvalue references：a new reference type，since C++0x，之前不能对右值取引用
        - 功能：避免不必要的copy，enable perfect forwarding
    - When the right-hand side of an assignment is an rvalue，then the left-hand side object can steal resources(指针的浅拷贝) from the right-hand side object rather than performing a separate allocation
    - Lvalue(左值)：可以出现在operator=左侧
        - 变量
    - Rvalue(右值)：只能出现在operator=右侧
        - 部分用户自定义的类没有遵守这个规则(例如：String,Complex)

        ```
        42;  // 字面值常量

        int a,b;
        a+b;

        string();  // 构造的临时对象

        int foo() {return 5};
        foo(); // 函数返回值（返回的是左值引用除外）
        ```

    - std::move(lvalue): 将左值变成右值引用，这个左值不能再使用，因为已经转移了
    - 使用场景

    ```C
    // 函数里面传右值
    c.insert(ite, Rvalue);

    // 调用参数是右值引用的函数
    insert(..., &&x)

    // insert会引起insert位置之后的元素换位置，之前是通过深拷贝（拷贝构造），如果参数是右值引用，调用该类型的移动构造（指针浅拷贝，同时原理的指针置为空）
    ```

    - https://www.bilibili.com/video/BV1Di4y1o7CD/?spm_id_from=333.337.search-card.all.click&vd_source=7798c62f92ce545f56fd00d4daf55e26
        - 右值引用支持移动构造，比拷贝构造节省开销
        - std::move()源码
- Perfect Forwarding: 完美转发
    - takes arguments and forwards them transparently to another arbitrary function
    - The natural of the argument(modifiable,const,lvalue or rvalue) is preserved in this forwarding process

- C++11新增容器
    - Array: 跟语言自带的array是一样的
    - Forward-List
    - Unordered Containers(Map,Set)

## C++ 11
- https://www.stroustrup.com/C++11FAQ.html

## C++ 14


## C++ 17
https://github.com/AnthonyCalandra/modern-cpp-features
https://en.cppreference.com/w/cpp/17
http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/n4713.pdf
https://github.com/cplusplus/draft

## C++ 20
- 《beginning C++ 20 -- From Novice to Professional》
    - 入门
    - http://product.dangdang.com/29383674.html
- C++20实践入门
- C++20高级编程
    - 进阶
    - https://book.douban.com/subject/35863224/

## 侯捷谈现代C++之深入浅出
https://www.bilibili.com/video/BV1cA4y1S7Dv/?spm_id_from=333.337.search-card.all.click&vd_source=7798c62f92ce545f56fd00d4daf55e26
- 主要特性：右值引用、移动语意、完美转发、万能引用
- 学习之道：宁下勿高，宁繁勿略，宁远勿近，宁拙勿巧